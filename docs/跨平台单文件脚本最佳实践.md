支持跨平台的单文件脚本，可以支持引入依赖，可以像shell一样直接作为命令执行。

[deno单文件脚本最佳实践](./cheatsheet/typescript/cross-platform-script-deno.md)
[node单文件脚本最佳实践](./cheatsheet/typescript/cross-platform-script-node.md)
[python单文件脚本最佳实践](./cheatsheet/python/cross-platform-script-python.md)
[rust单文件脚本最佳实践](./cheatsheet/rust/cross-platform-script-rust.md)
[golang单文件脚本最佳实践](./cheatsheet/golang/cross-platform-script-golang.md)
[pwsh单文件脚本最佳实践](./cheatsheet/pwsh/Pwsh跨平台脚本最佳实践.md)

以下是 **TypeScript (Deno/Node), PowerShell, Python, Golang, Rust** 的终极横向评测：

### 1. 核心特性对比表

| 语言方案 | **单文件依赖管理** | **启动/执行速度** | **编写舒适度 (DX)** | **跨平台能力** | **分发给别人** |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Deno (TS)** | ⭐⭐⭐⭐⭐<br>完美 (URL import) | ⭐⭐⭐⭐<br>快 (V8 引擎) | ⭐⭐⭐⭐⭐<br>类型提示强，语法现代 | ⭐⭐⭐⭐⭐<br>原生跨平台 | ⭐⭐⭐⭐⭐<br>可编译成独立 exe，零环境依赖 |
| **Node+tsx (TS)** | ⭐⭐<br>差 (需 package.json) | ⭐⭐⭐<br>较快 | ⭐⭐⭐⭐<br>生态大，但配置繁琐 | ⭐⭐⭐⭐<br>需 Node 环境 | ⭐⭐<br>对方必须装 Node 且 npm install |
| **Python (uv)** | ⭐⭐⭐⭐<br>优 (PEP 723 注释) | ⭐⭐<br>解释型，略慢 | ⭐⭐⭐⭐⭐<br>代码最简洁，库最丰富 | ⭐⭐⭐⭐⭐<br>需 Python 环境 | ⭐⭐⭐<br>对方需装 uv，或打包体积大 |
| **PowerShell** | ⭐<br>差 (模块安装繁琐) | ⭐⭐⭐<br>中等 | ⭐⭐<br>语法啰嗦，对象流难调试 | ⭐⭐⭐<br>Linux/Mac 需安装 | ⭐⭐⭐⭐<br>Windows 原生支持，其他需装 PS |
| **Golang** | ⭐⭐<br>差 (原生不支持单文件) | ⭐⭐⭐⭐⭐<br>极快 (编译型) | ⭐⭐⭐<br>写小逻辑太啰嗦 | ⭐⭐⭐⭐⭐<br>编译后无敌 | ⭐⭐⭐⭐⭐<br>直接给二进制文件 |
| **Rust** | ⭐⭐⭐<br>中 (Cargo Script) | ⭐⭐⭐⭐⭐<br>极快 (编译后) | ⭐⭐<br>写脚本心智负担太重 | ⭐⭐⭐⭐⭐<br>编译后无敌 | ⭐⭐⭐⭐⭐<br>直接给二进制文件 |

---

### 2. 深度点评与适用场景

#### 🏆 第一梯队：最佳脚本语言 (Deno vs Python)

这两个是目前写“单文件跨平台脚本”的**绝代双骄**。

* **TypeScript (Deno)**
  * **优点**：是目前**真正意义上**把“单文件+依赖”做得最好的。不需要额外的包管理工具，代码头部写个 `import` 就能跑。还能直接 `deno compile` 成一个独立的可执行文件（比如 `mytool.exe`），发给同事，同事连 Deno 都不用装。
  * **缺点**：虽然兼容 npm，但偶尔有些老旧的 npm 包在 Deno 下会有兼容性问题。
  * **结论**：**通用型脚本的首选。** 尤其是你需要把脚本给别人用的时候。

* **Python (配合 uv)**
  * **优点**：代码写起来最快，只要几行就能搞定复杂逻辑（爬虫、数据处理）。`uv` 的出现让 Python 终于有了类似 Deno 的体验（自动创建虚拟环境）。
  * **缺点**：你需要保证运行环境里装了 `uv`。如果不打包，对方必须有 Python 环境。
  * **结论**：**数据处理、AI、运维自动化的首选。** 如果你自己用，Python 是最舒服的。

#### 🥈 第二梯队：特定场景强者 (PowerShell vs Node.js)

* **PowerShell (Core)**
  * **场景**：如果你主要在管理 **Windows Server**、AD 域、Azure 资源，或者操作注册表、WMI。
  * **痛点**：作为通用脚本，它的语法非常怪异（动词-名词），在 Linux 上处理文本流不如 Bash/Python 方便。依赖管理（Install-Module）体验远不如 npm/pip。

* **Node.js (tsx)**
  * **场景**：**大型项目内部的脚本**。比如你的项目本身就是 Next.js/Vue，脚本需要引用项目里的 Utils 函数，那必须用 Node。
  * **痛点**：脱离了项目目录，单文件简直是灾难（依赖找不到、路径报错）。不适合做“独立小工具”。

#### 🥉 第三梯队：杀鸡用牛刀 (Golang vs Rust)

* **Golang**
  * **评价**：Go 是写**CLI 工具**（如 Docker, K8s, Terraform）的神器，而不是写脚本的。
  * **痛点**：字符串处理繁琐（没有 Python 的 `f-string` 或 JS 的模板字符串那么灵活），错误处理（`if err != nil`）写在脚本里让人崩溃。
  * **建议**：如果你发现脚本超过 500 行了，或者需要极高的并发性能，请把脚本升级为 Go 项目。

* **Rust**
  * **评价**：性能极其强悍，但开发效率最低。为了写个改文件名的脚本，你得处理所有权、生命周期、Result 解包……
  * **建议**：除非你的脚本是计算密集型（比如加密、图像压缩），否则不要用 Rust 写脚本。

---

### 3. 最终推荐：怎么选？

#### 场景 A：我要写一个工具，发给不懂技术的运营/产品/测试同事用

👉 **最佳选择：TypeScript (Deno)**

* **理由**：写完代码，执行 `deno compile main.ts`，生成一个 50MB 左右的 `.exe` 或二进制文件。直接发给对方，双击即用。零依赖，零环境配置。

#### 场景 B：我是运维/DevOps，我要写个脚本处理服务器日志、调用 AWS/阿里云 API

👉 **最佳选择：Python (uv)**

* **理由**：运维库丰富（boto3, requests, paramiko），代码短。配合 `uv` 解决了依赖地狱。

#### 场景 C：我是前端/全栈，想写个脚本自动重命名文件、转换图片格式

👉 **最佳选择：TypeScript (Deno)**

* **理由**：语言熟悉，可以使用 Web 标准 API，利用 Deno 的 URL import 直接引入社区库。

#### 场景 D：我主要在 Windows 环境下工作，管理系统配置

👉 **最佳选择：PowerShell**

* **理由**：原生优势，无法替代。

#### 场景 E：我要做一个高性能的端口扫描器，或者文件哈希计算器

👉 **最佳选择：Golang**

* **理由**：并发模型（Goroutine）简单强大，编译出的二进制文件体积小（比 Deno 小很多，通常 < 10MB）。

### 总结论

**如果只能学一个用来做跨平台脚本：请选择 Deno (TypeScript)。**

它是目前唯一平衡了 **“单文件依赖管理”**、**“开发体验”** 和 **“分发便利性”** 的现代化工具。
