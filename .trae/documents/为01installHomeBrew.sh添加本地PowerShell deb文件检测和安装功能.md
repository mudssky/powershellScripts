## Plan

### 影响面分析
- **修改文件**: `01installHomeBrew.sh`
- **潜在风险**: 改变现有 PowerShell 安装流程，需要保持向后兼容性

### Step 1: 逻辑重构
- 在第77行的 PowerShell 安装部分之前添加本地 deb 文件检测逻辑
- 保留原有的 `install_pwsh.sh` 调用作为后备方案

### Step 2: 实现本地检测功能
- 检测当前目录下是否存在符合命名模式的 `powershell_*.deb` 文件
- 如果找到多个 deb 文件，选择最新的一个
- 如果找到本地 deb 文件，直接使用 `dpkg -i` 安装并处理依赖
- 安装完成后清理临时文件（可选）

### Step 3: 错误处理和兼容性
- 如果本地安装失败，回退到原有的 `install_pwsh.sh` 脚本
- 保持原有的 pwsh 命令检测逻辑
- 添加适当的日志输出，让用户了解安装过程

### Step 4: 代码优化
- 将 PowerShell 安装逻辑封装为独立函数，提高代码可读性
- 确保所有操作都有适当的错误处理

### 实现细节
1. 创建 `install_local_powershell()` 函数
2. 修改主逻辑，优先尝试本地安装
3. 本地安装失败时才调用 `install_pwsh.sh`
4. 保持与现有代码风格一致的注释和错误处理