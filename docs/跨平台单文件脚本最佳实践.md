支持跨平台的单文件脚本，可以支持引入依赖，可以像shell一样直接作为命令执行。

[deno单文件脚本最佳实践](./cheatsheet/typescript/cross-platform-script-deno.md)
[node单文件脚本最佳实践](./cheatsheet/typescript/cross-platform-script-node.md)
[python单文件脚本最佳实践](./cheatsheet/python/cross-platform-script-python.md)
[rust单文件脚本最佳实践](./cheatsheet/rust/cross-platform-script-rust.md)
[golang单文件脚本最佳实践](./cheatsheet/golang/cross-platform-script-golang.md)
[pwsh单文件脚本最佳实践](./cheatsheet/pwsh/Pwsh跨平台脚本最佳实践.md)

以下是 **TypeScript (Deno/Node), PowerShell, Python, Golang, Rust** 终极评测：

### 1. 核心特性对比表

| 语言方案 | **零依赖能力**<br>(原生库强度) | **单文件依赖管理**<br>(若需引入外部库) | **编写舒适度 (DX)** | **跨平台能力** | **分发给别人** |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **PowerShell (pwsh)** | ⭐⭐⭐⭐⭐<br>**王者** (.NET库+对象管道) | ⭐⭐<br>较繁琐 (Install-Module) | ⭐⭐⭐<br>对象操作极爽，但语法啰嗦 | ⭐⭐⭐⭐<br>Win原生，Linux/Mac需装pwsh | ⭐⭐⭐⭐<br>脚本直接发，大部分环境能跑 |
| **Deno (TS)** | ⭐⭐⭐⭐<br>强 (内置 Web API) | ⭐⭐⭐⭐⭐<br>**完美** (URL import) | ⭐⭐⭐⭐⭐<br>类型强，语法现代 | ⭐⭐⭐⭐⭐<br>原生跨平台 | ⭐⭐⭐⭐⭐<br>可编译成独立 exe |
| **Python (uv)** | ⭐⭐⭐⭐<br>强 (标准库丰富) | ⭐⭐⭐⭐<br>优 (PEP 723) | ⭐⭐⭐⭐⭐<br>代码最简洁 | ⭐⭐⭐⭐⭐<br>需 Python 环境 | ⭐⭐⭐<br>对方需装 uv 或 Python |
| **Golang** | ⭐⭐⭐⭐<br>强 (net/http, json) | ⭐⭐<br>差 (需 go.mod) | ⭐⭐⭐<br>处理文本/JSON 比较繁琐 | ⭐⭐⭐⭐⭐<br>编译后无敌 | ⭐⭐⭐⭐⭐<br>直接给二进制文件 |
| **Node+tsx** | ⭐⭐<br>中 (新版才有 fetch) | ⭐⭐<br>差 (需 package.json) | ⭐⭐⭐⭐<br>生态大，但配置繁琐 | ⭐⭐⭐⭐<br>需 Node 环境 | ⭐⭐<br>环境配置麻烦 |
| **Rust** | ⭐⭐<br>弱 (标准库极精简) | ⭐⭐⭐<br>中 (Cargo Script) | ⭐⭐<br>几乎必须依赖第三方 crate | ⭐⭐⭐⭐⭐<br>编译后无敌 | ⭐⭐⭐⭐⭐<br>直接给二进制文件 |

---

### 2. 深度点评与重构排名

#### 🏆 第一梯队：脚本界的“绝代双骄” (PowerShell vs Deno)

如果你追求“单文件”，这两个是唯二的选择，取决于你的**领域**。

* **PowerShell Core (pwsh)** —— **系统运维与自动化的神**
  * **核心优势**：**对象管道 (Object Pipeline)** 是降维打击。
    * 在 Bash/Python 里处理进程，你需要 `grep` 切割字符串；在 pwsh 里，`Get-Process` 返回的是**对象**，直接 `.Name` 或 `.CPU` 就能拿数据。
    * **零依赖无敌**：原生支持 JSON/CSV/XML 解析、HTTP 请求 (`Invoke-RestMethod` 比 curl 强太多)、压缩解压、甚至直接调用 C#/.NET 库。
  * **缺点**：语法（动词-名词）比较冗长，冷启动速度稍慢。
  * **结论**：**如果不涉及复杂的算法逻辑，只是做文件/网络/系统操作，PowerShell 是最方便的，甚至不需要写依赖。**

* **TypeScript (Deno)** —— **通用逻辑与工具开发的神**
  * **核心优势**：**现代化的开发体验**。
    * 如果你需要写复杂的业务逻辑（数据转换、算法），TS 的类型系统和现代语法比 PowerShell 舒服太多。
    * **Web 标准**：内置 `fetch`, `WebSocket`, `WebStreams`，前端开发者零门槛。
  * **结论**：**如果你是开发人员，想写一个独立的小工具（CLI）分发给别人，或者逻辑比较复杂，选 Deno。**

#### 🥈 第二梯队：强大的通用选手 (Python vs Golang)

* **Python (配合 uv)**
  * **评价**：标准库 (`os`, `sys`, `json`) 很强，但致命伤是 HTTP 请求（`urllib` 难用）和命令行参数解析（`argparse` 啰嗦）。做正经脚本通常还是需要 `requests` 和 `click`/`typer`，这时就必须依赖 `uv` 这种工具来管理环境。
  * **适用**：数据科学、AI 调用、复杂的爬虫。

* **Golang**
  * **评价**：Go 的标准库非常“硬核”，自带生产级 HTTP Server/Client。但 Go 不适合写“脚本”是因为它处理动态数据（如随便解析一个未知结构的 JSON）太痛苦了，必须定义 Struct 或用 `map[string]interface{}` 断言。
  * **适用**：高性能并发任务，或者你本身就是 Go 开发者。

#### 🥉 第三梯队：生态依赖型 (Node.js vs Rust)

* **Node.js / Rust**：这两者在“单文件零依赖”场景下非常吃亏。Node 的标准库历史包袱重，Rust 的标准库为了精简甚至连随机数和正则都不自带。它们更适合**工程化开发**，而不是单文件脚本。

---

### 3. 最终推荐：根据场景精准选择

#### 场景 A：系统管理、流水线、胶水代码 (DevOps)

👉 **首选：PowerShell (pwsh)**

* **理由**：我要杀掉占用内存前 3 的进程，或者把 CSV 转成 JSON 发给 API。
  * **PWSH**: `Get-Process | Sort WS -Des | Select -First 3 | Stop-Process` (一行搞定，零依赖)
  * **Python**: 需 `import psutil` (非标准库)，写 10 行。
  * **Deno**: 需调用 `Deno.Command('ps')` 然后解析文本，写 20 行。

#### 场景 B：分发给小白用户的独立小工具

👉 **首选：TypeScript (Deno)**

* **理由**：写好代码 -> `deno compile` -> 发送 `.exe`。
* 用户不需要知道什么是 PowerShell 版本，也不需要安装 Python。

#### 场景 C：复杂的业务逻辑脚本 / 数据处理 / AI

👉 **首选：Python (uv)**

* **理由**：虽然 PowerShell 也能做数学计算，但 Python 代码可读性更高，且生态库（Pandas, Numpy）无法替代。

#### 场景 D：高性能网络工具 / 端口扫描

👉 **首选：Golang**

* **理由**：`go func()` 并发无敌，编译出来的二进制文件极小且无依赖。

### 总结修正

* **最强零依赖脚本语言**：**PowerShell** (不需要 install 任何东西就能干 90% 的运维活)。
* **最强开发体验脚本语言**：**Deno** (TS 类型加持 + 极简的依赖引入)。
* **最强生态脚本语言**：**Python** (万能胶水，但依赖管理稍麻烦)。
