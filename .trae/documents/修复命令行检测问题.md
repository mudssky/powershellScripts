## 修复计划

### 问题诊断
1. **缓存机制导致错误检测结果**：`Test-EXEProgram` 函数的缓存可能存储了过期的未安装状态
2. **PATH 环境变量问题**：Homebrew 安装的命令可能不在当前 PowerShell 会话的 PATH 中
3. **命令名称匹配问题**：需要验证实际命令名与配置中的 `cliName` 是否一致

### 修复步骤

#### Step 1: 添加缓存清理机制
- 在安装脚本开始时清除 `Test-EXEProgram` 的缓存
- 确保每次运行都进行实时检测

#### Step 2: 增强 PATH 检测
- 在 `Test-EXEProgram` 中添加对 Homebrew 路径的显式检查
- 支持 Linux 和 macOS 上 Homebrew 的典型安装路径

#### Step 3: 改进错误处理和调试
- 添加详细的 Verbose 输出，显示检测过程
- 在检测失败时输出更多诊断信息

#### Step 4: 验证配置一致性
- 检查配置文件中的 `cliName` 与实际安装的命令名是否匹配
- 必要时添加命令别名检测

#### Step 5: 测试验证
- 运行安装脚本验证修复效果
- 确保已安装的应用不会被重复安装

这个修复计划将解决命令行检测的准确性问题，避免重复安装已存在的工具。