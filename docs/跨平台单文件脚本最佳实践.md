支持跨平台的单文件脚本，可以支持引入依赖，可以像shell一样直接作为命令执行。

[deno单文件脚本最佳实践](./cheatsheet/typescript/cross-platform-script-deno.md)
[node单文件脚本最佳实践](./cheatsheet/typescript/cross-platform-script-node.md)
[python单文件脚本最佳实践](./cheatsheet/python/cross-platform-script-python.md)
[rust单文件脚本最佳实践](./cheatsheet/rust/cross-platform-script-rust.md)
[golang单文件脚本最佳实践](./cheatsheet/golang/cross-platform-script-golang.md)
[pwsh单文件脚本最佳实践](./cheatsheet/pwsh/Pwsh跨平台脚本最佳实践.md)

基于我们之前的深入讨论，结合 **启动速度、运行性能、零依赖能力、单文件依赖管理、编写舒适度 (DX)、跨平台兼容性** 这六大维度，以下是关于跨平台单文件脚本的**最终综合评测与排序**。

---

### 1.  全维度终极对比表 (七强争霸)

| 语言方案         | **启动速度**<br>(Cold Start) | **运行性能**<br>(CPU/Mem) | **零依赖能力**<br>(原生库/工具) | **单文件依赖管理**          | **编写舒适度**<br>(DX)      | **跨平台兼容性**               |
| ---------------- | ---------------------------- | ------------------------- | ------------------------------- | --------------------------- | --------------------------- | ------------------------------ |
| **Deno (TS)**    | ⭐⭐⭐⭐<br>快 (V8)              | ⭐⭐⭐⭐<br>快 (JIT)          | ⭐⭐⭐⭐<br>Web标准库               | 👑 **No.1**<br>URL Import    | 👑 **No.1**<br>TS+零配置     | ⭐⭐⭐⭐⭐<br>完美抹平差异          |
| **PowerShell**   | ⭐⭐<br>慢 (.NET加载)          | ⭐⭐⭐<br>中 (对象开销)      | 👑 **No.1**<br>对象管道+.NET     | ⭐⭐<br>繁琐 (Install-Module) | ⭐⭐⭐<br>系统操作爽，语法啰嗦 | ⭐⭐⭐⭐<br>Win原生, *nix需装      |
| **Python (uv)**  | ⭐⭐⭐<br>中等                  | ⭐⭐<br>较慢 (解释型)       | ⭐⭐⭐⭐<br>标准库强，HTTP弱        | ⭐⭐⭐⭐<br>优 (PEP 723)        | ⭐⭐⭐⭐⭐<br>极简主义           | ⭐⭐⭐⭐⭐<br>全平台可用            |
| **Golang**       | 👑 **No.1**<br>瞬间           | ⭐⭐⭐⭐⭐<br>极快             | ⭐⭐⭐⭐<br>网络强，数据弱          | ⭐⭐<br>差 (需 go.mod)        | ⭐⭐⭐<br>啰嗦                 | 👑 **No.1**<br>编译一次到处运行 |
| **Node + tsx**   | ⭐⭐⭐<br>中 (tsx 有开销)       | ⭐⭐⭐⭐<br>快 (V8)           | ⭐⭐<br>弱 (历史包袱)             | ⭐⭐<br>差 (需 package.json)  | ⭐⭐⭐⭐<br>TS爽，但配置繁琐    | ⭐⭐⭐⭐<br>需装Node               |
| **Rust**         | 👑 **No.1**<br>瞬间           | 👑 **No.1**<br>光速        | ⭐⭐<br>弱 (标准库贫瘠)           | ⭐⭐⭐<br>中 (Cargo Script)    | ⭐<br>心智负担重             | 👑 **No.1**<br>编译一次到处运行 |
| **Shell (Bash)** | 👑 **No.1**<br>瞬间           | 💀 **最慢**<br>进程开销大  | ⭐⭐<br>依赖系统命令              | 💀 **无**<br>无法管理        | ⭐<br>字符串地狱             | ⭐⭐<br>Win兼容性差              |

------

---

### 2. 分项冠军与梯队排名

#### 🏆 综合平衡冠军：Deno (TypeScript)

**—— “除了启动稍微慢于二进制，其他全是优点”**

* **入选理由**：它是唯一一个在**依赖管理**（URL import）、**开发体验**（TypeScript）、**跨平台**（标准库统一）三个核心痛点上都做到 90 分以上的工具。
* **短板**：零依赖能力不如 PowerShell（操作注册表/WMI 需要 fetch 或 外部命令），冷启动不如 Go。
* **最佳场景**：**编写通用工具、CLI、发给别人的脚本。**

#### 🥈 运维效率冠军：PowerShell (pwsh)

**—— “只要系统装了 pwsh，我就能徒手造航母”**

* **入选理由**：**零依赖能力王者**。能够直接处理 JSON、XML、CSV、HTTP、进程对象，无需下载任何包。这在封闭内网或临时环境的运维中是无敌的。
* **短板**：启动慢（写 CLI 交互体验不好），非 Windows 环境普及率不如 Python。
* **最佳场景**：**系统运维、CI/CD 流程、处理复杂格式数据（Excel/CSV/JSON）。**

#### 🥉 逻辑与生态冠军：Python (uv)

**—— “复杂的逻辑，用最少的代码写完”**

* **入选理由**：代码可读性最高，且拥有地球上最丰富的第三方库（AI、数据分析）。`uv` 的出现补齐了依赖管理的短板。
* **短板**：运行慢，分发麻烦（对方要有 Python 或 uv）。
* **最佳场景**：**数据处理、爬虫、AI 胶水代码、复杂算法验证。**

#### 🎖️ 性能与分发冠军：Golang

**—— “写完编译，十年后还能跑”**

* **入选理由**：**性能与分发的极致**。虽然写起来啰嗦，但它是唯一能生成极小体积（<10MB）、无依赖、且启动瞬间完成的方案。
* **短板**：由于 Go 甚至不想做脚本语言，单文件支持很差。
* **最佳场景**：**高并发网络工具（扫描器/代理）、需要分发给几千台机器的 Agent。**

---

### 3. 最终决策路线图

请根据你的**核心痛点**按顺序对号入座：

1. **“我要处理 1GB 的日志，或者搞高并发扫描，速度必须极快！”**
    👉 **Golang** (Rust 写起来太累，脚本场景 Go 足够快了)。

2. **“这个脚本要在 Windows Server 上跑，我不想（或不能）安装 pip/npm 那些乱七八糟的包。”**
    👉 **PowerShell** (原生对象管道吊打一切)。

3. **“我要写个小工具发给产品经理用，他不懂技术，双击要能跑。”**
    👉 **Deno** (`deno compile` 编译成 exe) 或 **Golang**。

4. **“这脚本逻辑挺复杂的，要调 API 又要清洗数据，但我希望代码能跨平台，Mac/Linux 都能用。”**
    👉 **Deno** (首选) 或 **Python (uv)**。

5. **“我只是想把 git, docker, kubectl 串起来执行几个命令，不想写太多代码。”**
    👉 **Shell (Bash)** (Linux/Mac) 或 **PowerShell** (Windows)。

### 总结一句话

* 做**运维和系统管理**，请拥抱 **PowerShell** 的对象管道。
* 做**独立工具和通用脚本**，请选择 **Deno** 的现代体验。
* 追求**极致性能和分发**，请使用 **Golang**。
